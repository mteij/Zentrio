<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Offline - Zentrio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#141414">
  <link rel="manifest" href="/static/site.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/logo/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/logo/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/logo/favicon/favicon-16x16.png">
  <link rel="icon" href="/static/logo/favicon/favicon.ico">
  <link rel="stylesheet" href="/static/css/styles.css">
  <link rel="stylesheet" href="/static/css/profiles.css">
  <link rel="stylesheet" href="/static/css/toast.css">
  <style>
    body {
        background: #141414;
        color: #e5e7eb;
        display: flex;
        min-height: 100vh;
        align-items: center;
        justify-content: center;
        margin: 0;
        font-family: 'Helvetica Neue', Arial, sans-serif;
    }
    .profile-container {
        text-align: center;
        z-index: 1;
        position: relative;
        animation: fadeIn 0.5s ease-out;
        background: rgba(20, 20, 20, 0.6);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        padding: 40px;
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }
    .profile-title {
        font-size: 3.5rem;
        font-weight: 500;
        margin-bottom: 2rem;
        color: #fff;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    .dino-game-container {
        width: 600px;
        height: 150px;
        margin: 0 auto 2rem;
        position: relative;
        overflow: hidden;
        border-bottom: 1px solid #535353;
    }
    .dino {
        width: 40px;
        height: 43px;
        background-color: #e50914; /* Zentrio accent */
        position: absolute;
        bottom: 0;
        left: 50px;
        mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11h2v2h-2v-2zm-2-2h2v2h-2V9zm-2-2h2v2h-2V7zm-2-2h2v2h-2V5zm-2-2h2v2h-2V3zM4 21h16v-2H4v2zm2-4h12v-2H6v2zm2-4h8v-2H8v2zm2-4h4V9h-4v2z"/></svg>') no-repeat center / contain;
        -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11h2v2h-2v-2zm-2-2h2v2h-2V9zm-2-2h2v2h-2V7zm-2-2h2v2h-2V5zm-2-2h2v2h-2V3zM4 21h16v-2H4v2zm2-4h12v-2H6v2zm2-4h8v-2H8v2zm2-4h4V9h-4v2z"/></svg>') no-repeat center / contain;
    }
    .cactus {
        width: 20px;
        height: 40px;
        background-color: #535353;
        position: absolute;
        bottom: 0;
        right: -20px;
    }
    .game-message {
        color: #808080;
        font-size: 14px;
        margin-top: 10px;
        min-height: 20px;
    }
    .manage-profiles-btn {
        background: transparent;
        border: 1px solid #808080;
        color: #808080;
        padding: 0.5em 1.5em;
        font-size: 1.2vw;
        text-transform: uppercase;
        letter-spacing: 2px;
        cursor: pointer;
        margin-top: 2em;
        transition: all 0.2s ease;
    }
    .manage-profiles-btn:hover {
        color: #fff;
        border-color: #fff;
    }
    .offline-actions {
        display: flex;
        gap: 20px;
        justify-content: center;
        margin-top: 30px;
    }
    .action-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        background: transparent;
        border: none;
        cursor: pointer;
        group: hover;
        text-decoration: none;
    }
    .action-icon {
        width: 10vw;
        height: 10vw;
        max-width: 150px;
        max-height: 150px;
        min-width: 84px;
        min-height: 84px;
        border-radius: 4px;
        background-color: #1f1f1f; /* Profile placeholder color */
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        border: 3px solid transparent;
    }
    .action-btn:hover .action-icon {
        background-color: #e5e5e5;
        border-color: #fff;
    }
    .action-btn:hover .action-icon svg {
        fill: #141414;
    }
    .action-label {
        color: #808080;
        font-size: 1.3vw;
        transition: color 0.2s ease;
    }
    .action-btn:hover .action-label {
        color: #fff;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: scale(1.1); }
        to { opacity: 1; transform: scale(1); }
    }
    @keyframes cactusMove {
        from { right: -20px; }
        to { right: 100%; }
    }
    .cactus.moving {
        animation: cactusMove 1.5s linear infinite;
    }
    .dino.jump {
        animation: jump 0.5s ease-out;
    }
    @keyframes jump {
        0% { bottom: 0; }
        50% { bottom: 60px; }
        100% { bottom: 0; }
    }
  </style>
</head>
<body>
  <div id="vanta-bg" style="position: fixed; inset: 0; z-index: 0; width: 100vw; height: 100vh;"></div>
  
  <div class="profile-container">
    <h1 class="profile-title">You're Offline</h1>
    
    <div class="dino-game-container" id="gameContainer" onclick="jump()">
        <div class="dino" id="dino"></div>
        <div class="cactus" id="cactus"></div>
    </div>
    <div class="game-message" id="gameMessage">Press Space or Click to Jump</div>

    <div class="offline-actions">
        <button class="action-btn" onclick="location.reload()">
            <div class="action-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="#808080">
                    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                </svg>
            </div>
            <span class="action-label">Retry</span>
        </button>
    </div>

    <button class="manage-profiles-btn" onclick="location.href='/'">GO HOME</button>
  </div>

  <div id="toast-container" class="toast-container"></div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.fog.min.js"></script>
  <script src="/static/js/theme.js"></script>
  <script src="/static/js/toast.js"></script>
  <script>
    // Dino Game Logic
    const dino = document.getElementById("dino");
    const cactus = document.getElementById("cactus");
    const gameMessage = document.getElementById("gameMessage");
    let isJumping = false;
    let isGameOver = false;
    let score = 0;

    function jump() {
        if (isJumping || isGameOver) {
            if (isGameOver) resetGame();
            return;
        }
        isJumping = true;
        dino.classList.add("jump");
        setTimeout(() => {
            dino.classList.remove("jump");
            isJumping = false;
        }, 500);
    }

    function resetGame() {
        isGameOver = false;
        score = 0;
        gameMessage.textContent = "Press Space or Click to Jump";
        cactus.classList.add("moving");
        checkDead();
    }

    document.addEventListener('keydown', (event) => {
        if (event.code === 'Space') {
            jump();
        }
    });

    function checkDead() {
        if (isGameOver) return;
        
        let dinoTop = parseInt(window.getComputedStyle(dino).getPropertyValue("top")); // Not used but good for debug
        // Actually we need bottom relative to container
        // But since we use animation for jump, we can check class or computed bottom
        // Let's use getBoundingClientRect for collision
        
        let dinoRect = dino.getBoundingClientRect();
        let cactusRect = cactus.getBoundingClientRect();

        // Simple collision
        if (cactusRect.left < dinoRect.right && cactusRect.right > dinoRect.left &&
            dinoRect.bottom > cactusRect.top) {
            
            isGameOver = true;
            cactus.classList.remove("moving");
            gameMessage.textContent = "Game Over! Score: " + Math.floor(score) + ". Click to restart.";
        } else {
            score += 0.1;
            if (!isGameOver) requestAnimationFrame(checkDead);
        }
    }

    // Start game
    cactus.classList.add("moving");
    checkDead();

    // Online/Offline Status
    (function(){
      function updateOnlineUI(){
        var online = navigator.onLine;
        if (online) {
            if (window.addToast) window.addToast('success','Online','Back online.');
            // Optional: Auto-reload when back online?
            // location.reload();
        }
      }
      if (!navigator.onLine && window.addToast) window.addToast('info', 'Offline', 'You are currently offline.');
      window.addEventListener('online', updateOnlineUI);
      window.addEventListener('offline', function(){ if (window.addToast) window.addToast('info','Offline','Connection lost.'); });
    })();
  </script>
</body>
</html>
