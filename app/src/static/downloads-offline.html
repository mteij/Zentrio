<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Downloads - Zentrio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#141414">
  <link rel="manifest" href="/static/site.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/logo/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/logo/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/logo/favicon/favicon-16x16.png">
  <link rel="icon" href="/static/logo/favicon/favicon.ico">
  <link rel="stylesheet" href="/static/css/styles.css">
  <link rel="stylesheet" href="/static/css/toast.css">
  <style>
    body { background:#0f0f10; color:#e5e7eb; }
    .container { max-width:980px; margin:60px auto 80px; padding:0 20px; }
    .dl-metric { background:#111827; border:1px solid #303b49; border-radius:8px; padding:10px 16px; min-width:120px; }
    .dl-metric-label { font-size:11px; letter-spacing:.5px; color:#9ca3af; text-transform:uppercase; margin-bottom:4px; }
    .dl-metric-value { font-size:18px; font-weight:600; color:#f9fafb; }
    .downloads-container { background:#1d1d1d; border:1px solid rgba(255,255,255,0.06); border-radius:10px; padding:26px 26px 8px; min-height:240px; position:relative; }
    .downloads-empty { text-align:center; color:#b3b3b3; font-size:15px; padding:40px 0; }
    .downloads-list { display:flex; flex-direction:column; gap:14px; }
    .download-folder-status { font-size:12px; color:#9ca3af; line-height:1.2; max-width:220px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .download-folder-status.ready { color:#10b981; }
    .btn { background:#1f2937; border:1px solid #374151; color:#d1d5db; font-size:12px; padding:6px 12px; border-radius:6px; cursor:pointer; }
    .btn.secondary { background:#111827; }
    .btn:disabled { opacity:.6; cursor:not-allowed; }
  </style>
</head>
<body>
  <div class="container">
    <h1 style="font-size:42px; margin-bottom:28px; font-weight:700;">Downloads</h1>

    <div style="margin-bottom:24px; display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
      <button id="downloadsBackBtn" type="button" class="btn secondary" title="Back to Profiles">← Back</button>
      <button id="setDownloadFolderBtn" type="button" class="btn" title="Select Download Folder (choose once)" data-online-required="false">Set Download Folder</button>
      <span id="downloadFolderStatus" class="download-folder-status">No folder selected</span>
    </div>

    <div id="downloadsSummary" style="display:flex; gap:24px; flex-wrap:wrap; margin-bottom:28px;">
      <div class="dl-metric">
        <div class="dl-metric-label">Active</div>
        <div class="dl-metric-value" id="dlMetricActive">0</div>
      </div>
      <div class="dl-metric">
        <div class="dl-metric-label">Completed</div>
        <div class="dl-metric-value" id="dlMetricCompleted">0</div>
      </div>
      <div class="dl-metric">
        <div class="dl-metric-label">Failed</div>
        <div class="dl-metric-value" id="dlMetricFailed">0</div>
      </div>
      <div class="dl-metric">
        <div class="dl-metric-label">Total Size</div>
        <div class="dl-metric-value" id="dlMetricSize">0</div>
      </div>
    </div>

    <div id="downloadsContainer" class="downloads-container">
      <div id="downloadsEmpty" class="downloads-empty">
        No downloads yet. Start a stream and click the ⬇ button.
      </div>
      <div id="downloadsList" class="downloads-list"></div>
    </div>

    <div id="downloadsMessage" class="message info" role="alert" aria-live="polite" style="display:none;"></div>
  </div>

  <div id="toast-container" class="toast-container"></div>

  <script src="/static/js/toast.js"></script>
  <script src="/static/js/downloads.js"></script>
  <script>
    (function(){
      if (!navigator.onLine) {
        if (window.addToast) window.addToast('info', 'Offline', 'Downloads available offline.');
      }
      window.addEventListener('offline', function(){ if (window.addToast) window.addToast('info', 'Offline', 'You are offline.'); });
      window.addEventListener('online', function(){ if (window.addToast) window.addToast('success', 'Online', 'Back online.'); });
    })();
  </script>
</body>
</html>
